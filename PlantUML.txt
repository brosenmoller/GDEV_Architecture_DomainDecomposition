@enduml

@startuml
!theme carbon-gray

title Hades - UML
header
  Assignment for HKU Game Dev Architecture
  Weapon System : Ben Rosenm√∂ller
  KeepsakeSystem : Joeri van Alphen
endheader

'General Code
class Player
{
  +int Health
  -WeaponManager weaponManager;
  -KeepsakeManager keepsakeManager;
}


Player *-- WeaponManager
Player *-- KeepsakeManager

static class EventManager
{
  +Action<HitInfo hit> OnPlayerAttack;
  +Action OnPlayerSpawn;
}

class Blackboard
{
  +int PlayerHealth;
  +int PlayerMoneyAmount;
}

'Weapon System
struct Damage
{
  +int MainDamage;
  +int BackstabDamage;
  +bool IsPoisned;
}

interface IDamageable
{
  +void TakeDamage(Damage damage);
}

abstract class Weapon
{
  +void ApplyEffect(out Damage damage);
}

class WeaponManager
{
  -Weapon[] unlockedWeapons;
  -Weapon[] equipedWeapons;
}

WeaponManager *-- Weapon
Weapon .. Damage
IDamageable .. Damage


'Keepsake System
interface IKeepsake
{
   +void Register();
   +void Unregister();
   #void OnEventCalled(KeepsakeContext context);
}

class KeepsakeManager
{
  -KeepsakeInventory Inventory;
  -KeepsakeListener Listener;
}

class KeepsakeInventory
{
  -IKeepsake[] unlockedKeepsakes;
  -IKeepsake[] equipedKeepsakes;
  
  +void Add(Keepsake keepsake);
  +void Set(int slot, Keepsake Keepsake);
}

class KeepsakeListener
{
  -Dictionary<KeepsakeEventType, Action> events
  +Action GetEvent(KeepsakeEventType eventType);
}

enum KeepsakeEventType
{
  ON_PLAYER_HIT,
  ON_PLAYER_ATTACK,
}

IKeepsake .. KeepsakeListener
KeepsakeManager *-- KeepsakeInventory
KeepsakeManager *-- KeepsakeListener
KeepsakeInventory *-- IKeepsake
KeepsakeListener o-- KeepsakeEventType

'Keepsake Variants
class DamageKeepsake
{
   +void Register();
   +void Unregister();
   #void OnEventCalled(KeepsakeContext context);
}

class HealthKeepsake
{
   +void Register();
   +void Unregister();
   #void OnEventCalled(KeepsakeContext context);
}

DamageKeepsake -u-|> IKeepsake
HealthKeepsake -u-|> IKeepsake

@enduml